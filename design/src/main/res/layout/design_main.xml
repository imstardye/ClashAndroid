<?xml version="1.0" encoding="utf-8"?>
<layout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto">
    <data>
        <variable
            name="self"
            type="com.github.kr328.clash.design.MainDesign" />
        <variable
            name="clashRunning"
            type="boolean" />
        <variable
            name="forwarded"
            type="String" />
        <variable
            name="forwardedLabel"
            type="String" />
        <variable
            name="mode"
            type="String" />
        <variable
            name="profileName"
            type="String" />
        <variable
            name="colorClashStarted"
            type="int" />
        <variable
            name="colorClashStopped"
            type="int" />
        <variable
            name="accessControlSummary"
            type="String" />
        <variable
            name="hasProviders"
            type="boolean" />
        <variable
            name="trafficSpeedText"
            type="String" />
        <variable
            name="hasTrafficHistory"
            type="boolean" />

        <import type="android.view.View" />
        <import type="com.github.kr328.clash.design.MainDesign.Request" />
    </data>

    <androidx.coordinatorlayout.widget.CoordinatorLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:paddingStart="@{self.surface.insets.start}"
        android:paddingEnd="@{self.surface.insets.end}">

        <androidx.core.widget.NestedScrollView
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:clipToPadding="false"
            android:scrollbars="none">

            <androidx.constraintlayout.widget.ConstraintLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content">

                <LinearLayout
                    android:id="@+id/mainContentContainer"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:animateLayoutChanges="true"
                    android:orientation="vertical"
                    android:paddingHorizontal="@dimen/main_padding_horizontal"
                    android:paddingTop="@{self.surface.insets.top}"
                    android:paddingBottom="@{self.surface.insets.bottom}"
                    app:layout_constrainedWidth="true"
                    app:layout_constraintEnd_toEndOf="parent"
                    app:layout_constraintStart_toStartOf="parent"
                    app:layout_constraintTop_toTopOf="parent"
                    app:layout_constraintWidth_default="wrap"
                    app:layout_constraintWidth_max="@dimen/main_content_max_width">

                <LinearLayout
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:gravity="center_vertical"
                    android:minHeight="@dimen/main_top_banner_height"
                    android:orientation="horizontal"
                    android:paddingTop="8dp"
                    android:paddingBottom="8dp">

                    <FrameLayout
                        android:layout_width="@dimen/large_item_header_layout_size"
                        android:layout_height="@dimen/large_item_header_layout_size">

                        <View
                            android:layout_width="@dimen/main_logo_size"
                            android:layout_height="@dimen/main_logo_size"
                            android:layout_gravity="center"
                            android:background="@drawable/ic_clash" />
                    </FrameLayout>

                    <LinearLayout
                        android:layout_width="0dp"
                        android:layout_height="wrap_content"
                        android:layout_weight="1"
                        android:orientation="vertical">

                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="@string/application_name"
                            android:textAppearance="@style/TextAppearance.MaterialComponents.Headline5"
                            android:textStyle="bold" />
                    </LinearLayout>
                </LinearLayout>

                <com.google.android.material.card.MaterialCardView
                    android:id="@+id/statusCard"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_marginTop="@dimen/main_dashboard_item_spacing"
                    android:clickable="true"
                    android:focusable="true"
                    android:foreground="?attr/selectableItemBackground"
                    android:onClick="@{() -> self.request(Request.toggleStatus())}"
                    app:contentPadding="@dimen/main_card_content_padding"
                    app:strokeColor="@android:color/transparent"
                    app:cardElevation="@dimen/main_status_card_elevation"
                    app:cardCornerRadius="@dimen/main_card_corner_radius"
                    app:cardBackgroundColor="@{clashRunning ? colorClashStarted : colorClashStopped}">

                    <LinearLayout
                        android:layout_width="match_parent"
                        android:layout_height="wrap_content"
                        android:orientation="vertical">

                        <LinearLayout
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:orientation="horizontal"
                            android:gravity="center_vertical">

                            <TextView
                                android:id="@+id/statusTitle"
                                android:layout_width="0dp"
                                android:layout_height="wrap_content"
                                android:layout_weight="1"
                                android:text="@string/dashboard_status_title"
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Headline5"
                                android:textStyle="bold"
                                android:textColor="@android:color/white" />

                            <View
                                android:layout_width="12dp"
                                android:layout_height="12dp"
                                android:layout_marginStart="8dp"
                                android:background="@drawable/ic_baseline_flash_on"
                                android:visibility="@{clashRunning ? View.VISIBLE : View.GONE}" />
                        </LinearLayout>

                        <TextView
                            android:id="@+id/statusSubtitle"
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_section_spacing"
                            android:text='@{profileName != null ? @string/format_profile_activated(profileName) : @string/not_selected}'
                            android:textAppearance="@style/TextAppearance.MaterialComponents.Body1"
                            android:textColor="@android:color/white"
                            android:alpha="0.9" />

                        <TextView
                            android:id="@+id/statusMode"
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            android:text='@{mode}'
                            android:textAppearance="@style/TextAppearance.MaterialComponents.Body2"
                            android:textColor="@android:color/white"
                            android:alpha="0.85" />

                        <TextView
                            android:id="@+id/statusForwarded"
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            android:text='@{clashRunning ? @string/format_traffic_forwarded(forwarded) : @string/tap_to_start}'
                            android:textAppearance="@style/TextAppearance.MaterialComponents.Body2"
                            android:textColor="@android:color/white"
                            android:alpha="0.85" />

                        <com.google.android.material.button.MaterialButton
                            android:id="@+id/statusToggle"
                            style="@style/Widget.Clash.Button"
                            android:layout_width="match_parent"
                            android:layout_height="@dimen/main_status_button_height"
                            android:layout_marginTop="@dimen/main_card_section_spacing"
                            android:onClick="@{() -> self.request(Request.toggleStatus())}"
                            android:text='@{clashRunning ? @string/stop_service : @string/start_service}'
                            android:textSize="16sp"
                            android:textStyle="bold"
                            android:textColor='@{clashRunning ? @android:color/white : @color/color_status_button_start_foreground}'
                            android:backgroundTint='@{clashRunning ? @color/color_status_button_stop_background : @color/color_status_button_start_background}'
                            app:icon='@{clashRunning ? @drawable/ic_baseline_stop : @drawable/ic_baseline_play_arrow}'
                            app:iconGravity="textStart"
                            app:iconSize="28dp"
                            app:iconPadding="@dimen/main_status_button_icon_padding"
                            app:iconTint='@{clashRunning ? @android:color/white : @color/color_status_button_start_foreground}'
                            app:strokeColor="@android:color/transparent"
                            app:cornerRadius="16dp"
                            app:elevation="4dp" />
                    </LinearLayout>
                </com.google.android.material.card.MaterialCardView>

                <com.google.android.material.card.MaterialCardView
                    android:id="@+id/trafficCard"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_marginTop="@dimen/main_dashboard_item_spacing"
                    app:contentPadding="@dimen/main_card_content_padding"
                    app:cardElevation="@dimen/main_card_elevation"
                    app:cardCornerRadius="@dimen/main_card_corner_radius"
                    app:strokeWidth="1dp"
                    app:strokeColor="@color/color_tech_glow">

                    <LinearLayout
                        android:layout_width="match_parent"
                        android:layout_height="wrap_content"
                        android:orientation="vertical">

                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="@string/traffic_overview"
                            android:textAppearance="@style/TextAppearance.MaterialComponents.Headline6"
                            android:textStyle="bold" />

                        <TextView
                            android:id="@+id/trafficSpeed"
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            android:text='@{trafficSpeedText}'
                            android:textAppearance="@style/TextAppearance.MaterialComponents.Body1"
                            android:textStyle="bold"
                            android:textColor="?attr/colorPrimary" />

                        <FrameLayout
                            android:layout_width="match_parent"
                            android:layout_height="@dimen/main_traffic_chart_height"
                            android:layout_marginTop="@dimen/main_card_section_spacing">

                            <com.github.kr328.clash.design.view.TrafficTrendView
                                android:id="@+id/trafficChart"
                                android:layout_width="match_parent"
                                android:layout_height="match_parent"
                                android:contentDescription="@string/traffic_chart_empty" />

                            <TextView
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"
                                android:layout_gravity="center"
                                android:text="@string/traffic_chart_empty"
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Body2"
                                android:textColor="?attr/colorOnSurface"
                                android:alpha="0.6"
                                android:visibility="@{hasTrafficHistory ? View.GONE : View.VISIBLE}" />
                        </FrameLayout>

                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            android:text='@{forwardedLabel}'
                            android:textAppearance="@style/TextAppearance.MaterialComponents.Body2" />

                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            android:text="@string/traffic_history_hint"
                            android:textAppearance="@style/TextAppearance.MaterialComponents.Caption"
                            android:alpha="0.7" />
                    </LinearLayout>
                </com.google.android.material.card.MaterialCardView>

                <com.google.android.material.card.MaterialCardView
                    android:id="@+id/connectionCard"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_marginTop="@dimen/main_dashboard_item_spacing"
                    app:contentPadding="@dimen/main_card_content_padding"
                    app:cardElevation="@dimen/main_card_elevation"
                    app:cardCornerRadius="@dimen/main_card_corner_radius"
                    app:strokeWidth="1dp"
                    app:strokeColor="@color/color_tech_glow">

                    <LinearLayout
                        android:layout_width="match_parent"
                        android:layout_height="wrap_content"
                        android:orientation="vertical">

                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="@string/connection_overview"
                            android:textAppearance="@style/TextAppearance.MaterialComponents.Headline6"
                            android:textStyle="bold" />

                        <LinearLayout
                            android:id="@+id/currentModeRow"
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            android:gravity="center_vertical"
                            android:orientation="horizontal">

                            <TextView
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"
                                android:text="@string/current_mode_label"
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Body2" />

                            <TextView
                                android:layout_width="0dp"
                                android:layout_height="wrap_content"
                                android:layout_marginStart="@dimen/main_card_value_spacing"
                                android:layout_weight="1"
                                android:text='@{mode}'
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Body1" />
                        </LinearLayout>

                        <com.google.android.material.button.MaterialButtonToggleGroup
                            android:id="@+id/modeToggleGroup"
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            app:selectionRequired="true"
                            app:singleSelection="true">

                            <com.google.android.material.button.MaterialButton
                                android:id="@+id/modeDirectButton"
                                style="@style/Widget.Clash.Button.Outlined"
                                android:layout_width="0dp"
                                android:layout_height="wrap_content"
                                android:layout_marginEnd="@dimen/main_card_item_spacing"
                                android:layout_weight="1"
                                android:text="@string/direct_mode" />

                            <com.google.android.material.button.MaterialButton
                                android:id="@+id/modeRuleButton"
                                style="@style/Widget.Clash.Button.Outlined"
                                android:layout_width="0dp"
                                android:layout_height="wrap_content"
                                android:layout_marginEnd="@dimen/main_card_item_spacing"
                                android:layout_weight="1"
                                android:text="@string/rule_mode" />

                            <com.google.android.material.button.MaterialButton
                                android:id="@+id/modeGlobalButton"
                                style="@style/Widget.Clash.Button.Outlined"
                                android:layout_width="0dp"
                                android:layout_height="wrap_content"
                                android:layout_weight="1"
                                android:text="@string/global_mode" />
                        </com.google.android.material.button.MaterialButtonToggleGroup>

                        <com.google.android.material.textfield.TextInputLayout
                            android:id="@+id/globalProxyDropdownLayout"
                            style="@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox.ExposedDropdownMenu"
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            android:hint="@string/global_proxy_selection"
                            android:visibility="gone"
                            app:endIconMode="dropdown_menu">

                            <com.google.android.material.textfield.MaterialAutoCompleteTextView
                                android:id="@+id/globalProxyDropdown"
                                android:layout_width="match_parent"
                                android:layout_height="wrap_content"
                                android:importantForAutofill="no"
                                android:inputType="none" />
                        </com.google.android.material.textfield.TextInputLayout>

                        <LinearLayout
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            android:gravity="center_vertical"
                            android:orientation="horizontal">

                            <TextView
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"
                                android:text="@string/active_profile_label"
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Body2" />

                            <TextView
                                android:layout_width="0dp"
                                android:layout_height="wrap_content"
                                android:layout_marginStart="@dimen/main_card_value_spacing"
                                android:layout_weight="1"
                                android:text='@{profileName != null ? profileName : @string/not_selected}'
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Body1" />
                        </LinearLayout>

                        <LinearLayout
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            android:gravity="center_vertical"
                            android:orientation="horizontal">

                            <TextView
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"
                                android:text="@string/providers_label"
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Body2" />

                            <TextView
                                android:layout_width="0dp"
                                android:layout_height="wrap_content"
                                android:layout_marginStart="@dimen/main_card_value_spacing"
                                android:layout_weight="1"
                                android:text='@{hasProviders ? @string/providers_available : @string/providers_unavailable}'
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Body1" />
                        </LinearLayout>

                        <com.google.android.material.divider.MaterialDivider
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginVertical="@dimen/main_card_section_spacing" />

                        <com.github.kr328.clash.design.view.LargeActionLabel
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:onClick="@{() -> self.request(Request.openProxy())}"
                            app:icon="@drawable/ic_baseline_apps"
                            app:subtext="@string/manage_proxy"
                            app:text="@string/proxy" />

                        <com.github.kr328.clash.design.view.LargeActionLabel
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            android:onClick="@{() -> self.request(Request.openProfiles())}"
                            app:icon="@drawable/ic_baseline_view_list"
                            app:subtext='@{profileName != null ? @string/manage_profiles : @string/not_selected}'
                            app:text="@string/profiles" />

                        <com.github.kr328.clash.design.view.LargeActionLabel
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            android:onClick="@{() -> self.request(Request.openProviders())}"
                            android:visibility="@{hasProviders ? View.VISIBLE : View.GONE}"
                            app:icon="@drawable/ic_baseline_swap_vertical_circle"
                            app:subtext="@string/manage_providers"
                            app:text="@string/providers" />
                    </LinearLayout>
                </com.google.android.material.card.MaterialCardView>

                <com.google.android.material.card.MaterialCardView
                    android:id="@+id/navigationCard"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_marginTop="@dimen/main_dashboard_item_spacing"
                    android:layout_marginBottom="@dimen/main_dashboard_item_spacing"
                    app:contentPadding="@dimen/main_card_content_padding"
                    app:cardElevation="@dimen/main_card_elevation"
                    app:cardCornerRadius="@dimen/main_card_corner_radius"
                    app:strokeWidth="1dp"
                    app:strokeColor="@color/color_tech_glow">

                    <LinearLayout
                        android:layout_width="match_parent"
                        android:layout_height="wrap_content"
                        android:orientation="vertical">

                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="@string/quick_actions"
                            android:textAppearance="@style/TextAppearance.MaterialComponents.Headline6"
                            android:textStyle="bold" />

                        <com.github.kr328.clash.design.view.LargeActionLabel
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            android:onClick="@{() -> self.request(Request.openAccessControl())}"
                            app:icon="@drawable/ic_baseline_vpn_lock"
                            app:subtext='@{accessControlSummary != null ? accessControlSummary : @string/access_control_mode}'
                            app:text="@string/access_control_quick" />

                        <com.github.kr328.clash.design.view.LargeActionLabel
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            android:onClick="@{() -> self.request(Request.openLogs())}"
                            app:icon="@drawable/ic_baseline_assignment"
                            app:subtext="@string/view_logs"
                            app:text="@string/logs" />

                        <com.github.kr328.clash.design.view.LargeActionLabel
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            android:onClick="@{() -> self.request(Request.openSettings())}"
                            app:icon="@drawable/ic_baseline_settings"
                            app:subtext="@string/open_settings"
                            app:text="@string/settings" />

                        <com.github.kr328.clash.design.view.LargeActionLabel
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_card_item_spacing"
                            android:onClick="@{() -> self.request(Request.openAbout())}"
                            app:icon="@drawable/ic_baseline_info"
                            app:subtext="@string/about_app"
                            app:text="@string/about" />
                    </LinearLayout>
                </com.google.android.material.card.MaterialCardView>
            </LinearLayout>
        </androidx.constraintlayout.widget.ConstraintLayout>
        </androidx.core.widget.NestedScrollView>
    </androidx.coordinatorlayout.widget.CoordinatorLayout>
</layout>
