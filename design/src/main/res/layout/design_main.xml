<?xml version="1.0" encoding="utf-8"?>
<layout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto">
    <data>
        <variable
            name="self"
            type="com.github.kr328.clash.design.MainDesign" />
        <variable
            name="clashRunning"
            type="boolean" />
        <variable
            name="forwarded"
            type="String" />
        <variable
            name="forwardedLabel"
            type="String" />
        <variable
            name="mode"
            type="String" />
        <variable
            name="profileName"
            type="String" />
        <variable
            name="colorClashStarted"
            type="int" />
        <variable
            name="colorClashStopped"
            type="int" />
        <variable
            name="hasProviders"
            type="boolean" />
        <variable
            name="trafficSpeed"
            type="String" />
        <variable
            name="hasTrafficHistory"
            type="boolean" />

        <import type="android.view.View" />
        <import type="com.github.kr328.clash.design.MainDesign.Request" />
    </data>

    <androidx.coordinatorlayout.widget.CoordinatorLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:paddingStart="@{self.surface.insets.start}"
        android:paddingEnd="@{self.surface.insets.end}">

        <androidx.core.widget.NestedScrollView
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:clipToPadding="false"
            android:scrollbars="none">

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:animateLayoutChanges="true"
                android:clipToPadding="false"
                android:orientation="vertical"
                android:paddingHorizontal="@dimen/main_padding_horizontal"
                android:paddingTop="@{self.surface.insets.top}"
                android:paddingBottom="@{self.surface.insets.bottom}">

                <LinearLayout
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:gravity="center_vertical"
                    android:minHeight="@dimen/main_top_banner_height"
                    android:orientation="horizontal">

                    <FrameLayout
                        android:layout_width="@dimen/large_item_header_layout_size"
                        android:layout_height="@dimen/large_item_header_layout_size">

                        <View
                            android:layout_width="@dimen/main_logo_size"
                            android:layout_height="@dimen/main_logo_size"
                            android:layout_gravity="center"
                            android:background="@drawable/ic_clash" />
                    </FrameLayout>

                    <LinearLayout
                        android:layout_width="0dp"
                        android:layout_height="wrap_content"
                        android:layout_weight="1"
                        android:orientation="vertical">

                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="@string/application_name"
                            android:textAppearance="@style/TextAppearance.MaterialComponents.Headline6" />

                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:layout_marginTop="@dimen/main_header_subtitle_margin"
                            android:text="@string/dashboard_subtitle"
                            android:textAppearance="@style/TextAppearance.MaterialComponents.Body2" />
                    </LinearLayout>
                </LinearLayout>

                <androidx.gridlayout.widget.GridLayout
                    android:id="@+id/dashboardGrid"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:alignmentMode="alignMargins"
                    android:columnCount="@integer/main_dashboard_columns"
                    android:rowOrderPreserved="false"
                    android:useDefaultMargins="false"
                    android:paddingBottom="@dimen/main_dashboard_grid_bottom_padding">

                    <com.google.android.material.card.MaterialCardView
                        android:id="@+id/statusCard"
                        android:layout_width="0dp"
                        android:layout_height="wrap_content"
                        android:layout_margin="@dimen/main_dashboard_item_spacing"
                        android:clickable="true"
                        android:focusable="true"
                        android:foreground="?attr/selectableItemBackground"
                        android:onClick="@{() -> self.request(Request.ToggleStatus)}"
                        android:padding="@dimen/main_card_content_padding"
                        app:cardBackgroundColor="@{clashRunning ? colorClashStarted : colorClashStopped}"
                        app:layout_columnSpan="@integer/main_dashboard_columns">

                        <LinearLayout
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:orientation="vertical">

                            <TextView
                                android:id="@+id/statusTitle"
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"
                                android:text="@string/dashboard_status_title"
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Headline6"
                                android:textColor="@android:color/white" />

                            <TextView
                                android:id="@+id/statusSubtitle"
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"
                                android:layout_marginTop="@dimen/main_card_section_spacing"
                                android:text='@{profileName != null ? @string/format_profile_activated(profileName) : @string/not_selected}'
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Body2"
                                android:textColor="@android:color/white" />

                            <TextView
                                android:id="@+id/statusMode"
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"
                                android:layout_marginTop="@dimen/main_card_item_spacing"
                                android:text='@{mode}'
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Body1"
                                android:textColor="@android:color/white" />

                            <TextView
                                android:id="@+id/statusForwarded"
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"
                                android:layout_marginTop="@dimen/main_card_item_spacing"
                                android:text='@{clashRunning ? @string/format_traffic_forwarded(forwarded) : @string/tap_to_start}'
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Body2"
                                android:textColor="@android:color/white" />

                            <com.google.android.material.button.MaterialButton
                                android:id="@+id/statusToggle"
                                style="@style/Widget.MaterialComponents.Button.OutlinedButton"
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"
                                android:layout_marginTop="@dimen/main_card_section_spacing"
                                android:onClick="@{() -> self.request(Request.ToggleStatus)}"
                                android:text='@{clashRunning ? @string/stop_service : @string/start_service}'
                                android:textColor="@android:color/white"
                                app:icon='@{clashRunning ? @drawable/ic_baseline_stop : @drawable/ic_baseline_play_arrow}'
                                app:iconGravity="textStart"
                                app:iconPadding="@dimen/main_status_button_icon_padding"
                                app:iconTint="@android:color/white"
                                app:strokeColor="@android:color/white"
                                app:strokeWidth="@dimen/main_status_button_stroke" />
                        </LinearLayout>
                    </com.google.android.material.card.MaterialCardView>

                    <com.google.android.material.card.MaterialCardView
                        android:id="@+id/trafficCard"
                        android:layout_width="0dp"
                        android:layout_height="wrap_content"
                        android:layout_margin="@dimen/main_dashboard_item_spacing"
                        android:padding="@dimen/main_card_content_padding"
                        app:layout_columnSpan="@integer/main_dashboard_columns">

                        <LinearLayout
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:orientation="vertical">

                            <TextView
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"
                                android:text="@string/traffic_overview"
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Headline6" />

                            <TextView
                                android:id="@+id/trafficSpeed"
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"
                                android:layout_marginTop="@dimen/main_card_item_spacing"
                                android:text='@{trafficSpeed}'
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Body2" />

                            <FrameLayout
                                android:layout_width="match_parent"
                                android:layout_height="@dimen/main_traffic_chart_height"
                                android:layout_marginTop="@dimen/main_card_section_spacing">

                                <com.github.kr328.clash.design.view.TrafficTrendView
                                    android:id="@+id/trafficChart"
                                    android:layout_width="match_parent"
                                    android:layout_height="match_parent"
                                    android:contentDescription="@string/traffic_chart_empty" />

                                <TextView
                                    android:layout_width="wrap_content"
                                    android:layout_height="wrap_content"
                                    android:layout_gravity="center"
                                    android:text="@string/traffic_chart_empty"
                                    android:textAppearance="@style/TextAppearance.MaterialComponents.Body2"
                                    android:textColor="?attr/colorOnSurface"
                                    android:visibility="@{hasTrafficHistory ? View.GONE : View.VISIBLE}" />
                            </FrameLayout>

                            <TextView
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"
                                android:layout_marginTop="@dimen/main_card_item_spacing"
                                android:text='@{forwardedLabel}'
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Body2" />

                            <TextView
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"
                                android:layout_marginTop="@dimen/main_card_item_spacing"
                                android:text="@string/traffic_history_hint"
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Caption" />
                        </LinearLayout>
                    </com.google.android.material.card.MaterialCardView>

                    <com.google.android.material.card.MaterialCardView
                        android:id="@+id/connectionCard"
                        android:layout_width="0dp"
                        android:layout_height="wrap_content"
                        android:layout_margin="@dimen/main_dashboard_item_spacing"
                        android:padding="@dimen/main_card_content_padding"
                        app:layout_columnWeight="1"
                        app:layout_rowWeight="1">

                        <LinearLayout
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:orientation="vertical">

                            <TextView
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"
                                android:text="@string/connection_overview"
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Headline6" />

                            <LinearLayout
                                android:layout_width="match_parent"
                                android:layout_height="wrap_content"
                                android:layout_marginTop="@dimen/main_card_item_spacing"
                                android:gravity="center_vertical"
                                android:orientation="horizontal">

                                <TextView
                                    android:layout_width="wrap_content"
                                    android:layout_height="wrap_content"
                                    android:text="@string/current_mode_label"
                                    android:textAppearance="@style/TextAppearance.MaterialComponents.Body2" />

                                <TextView
                                    android:layout_width="0dp"
                                    android:layout_height="wrap_content"
                                    android:layout_marginStart="@dimen/main_card_value_spacing"
                                    android:layout_weight="1"
                                    android:text='@{mode}'
                                    android:textAppearance="@style/TextAppearance.MaterialComponents.Body1" />
                            </LinearLayout>

                            <LinearLayout
                                android:layout_width="match_parent"
                                android:layout_height="wrap_content"
                                android:layout_marginTop="@dimen/main_card_item_spacing"
                                android:gravity="center_vertical"
                                android:orientation="horizontal">

                                <TextView
                                    android:layout_width="wrap_content"
                                    android:layout_height="wrap_content"
                                    android:text="@string/active_profile_label"
                                    android:textAppearance="@style/TextAppearance.MaterialComponents.Body2" />

                                <TextView
                                    android:layout_width="0dp"
                                    android:layout_height="wrap_content"
                                    android:layout_marginStart="@dimen/main_card_value_spacing"
                                    android:layout_weight="1"
                                    android:text='@{profileName != null ? profileName : @string/not_selected}'
                                    android:textAppearance="@style/TextAppearance.MaterialComponents.Body1" />
                            </LinearLayout>

                            <LinearLayout
                                android:layout_width="match_parent"
                                android:layout_height="wrap_content"
                                android:layout_marginTop="@dimen/main_card_item_spacing"
                                android:gravity="center_vertical"
                                android:orientation="horizontal">

                                <TextView
                                    android:layout_width="wrap_content"
                                    android:layout_height="wrap_content"
                                    android:text="@string/providers_label"
                                    android:textAppearance="@style/TextAppearance.MaterialComponents.Body2" />

                                <TextView
                                    android:layout_width="0dp"
                                    android:layout_height="wrap_content"
                                    android:layout_marginStart="@dimen/main_card_value_spacing"
                                    android:layout_weight="1"
                                    android:text='@{hasProviders ? @string/providers_available : @string/providers_unavailable}'
                                    android:textAppearance="@style/TextAppearance.MaterialComponents.Body1" />
                            </LinearLayout>

                            <com.google.android.material.divider.MaterialDivider
                                android:layout_width="match_parent"
                                android:layout_height="wrap_content"
                                android:layout_marginVertical="@dimen/main_card_section_spacing" />

                            <com.github.kr328.clash.design.view.LargeActionLabel
                                android:layout_width="match_parent"
                                android:layout_height="wrap_content"
                                android:onClick="@{() -> self.request(Request.OpenProxy)}"
                                app:icon="@drawable/ic_baseline_apps"
                                app:subtext="@string/manage_proxy"
                                app:text="@string/proxy" />

                            <com.github.kr328.clash.design.view.LargeActionLabel
                                android:layout_width="match_parent"
                                android:layout_height="wrap_content"
                                android:onClick="@{() -> self.request(Request.OpenProfiles)}"
                                app:icon="@drawable/ic_baseline_view_list"
                                app:subtext='@{profileName != null ? @string/manage_profiles : @string/not_selected}'
                                app:text="@string/profiles" />

                            <com.github.kr328.clash.design.view.LargeActionLabel
                                android:layout_width="match_parent"
                                android:layout_height="wrap_content"
                                android:onClick="@{() -> self.request(Request.OpenProviders)}"
                                android:visibility="@{hasProviders ? View.VISIBLE : View.GONE}"
                                app:icon="@drawable/ic_baseline_swap_vertical_circle"
                                app:subtext="@string/manage_providers"
                                app:text="@string/providers" />
                        </LinearLayout>
                    </com.google.android.material.card.MaterialCardView>

                    <com.google.android.material.card.MaterialCardView
                        android:id="@+id/navigationCard"
                        android:layout_width="0dp"
                        android:layout_height="wrap_content"
                        android:layout_margin="@dimen/main_dashboard_item_spacing"
                        android:padding="@dimen/main_card_content_padding"
                        app:layout_columnWeight="1"
                        app:layout_rowWeight="1">

                        <LinearLayout
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:orientation="vertical">

                            <TextView
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"
                                android:text="@string/quick_actions"
                                android:textAppearance="@style/TextAppearance.MaterialComponents.Headline6" />

                            <com.github.kr328.clash.design.view.LargeActionLabel
                                android:layout_width="match_parent"
                                android:layout_height="wrap_content"
                                android:layout_marginTop="@dimen/main_card_item_spacing"
                                android:onClick="@{() -> self.request(Request.OpenLogs)}"
                                app:icon="@drawable/ic_baseline_assignment"
                                app:subtext="@string/view_logs"
                                app:text="@string/logs" />

                            <com.github.kr328.clash.design.view.LargeActionLabel
                                android:layout_width="match_parent"
                                android:layout_height="wrap_content"
                                android:onClick="@{() -> self.request(Request.OpenSettings)}"
                                app:icon="@drawable/ic_baseline_settings"
                                app:subtext="@string/open_settings"
                                app:text="@string/settings" />

                            <com.github.kr328.clash.design.view.LargeActionLabel
                                android:layout_width="match_parent"
                                android:layout_height="wrap_content"
                                android:onClick="@{() -> self.request(Request.OpenHelp)}"
                                app:icon="@drawable/ic_baseline_help_center"
                                app:subtext="@string/get_help"
                                app:text="@string/help" />

                            <com.github.kr328.clash.design.view.LargeActionLabel
                                android:layout_width="match_parent"
                                android:layout_height="wrap_content"
                                android:onClick="@{() -> self.request(Request.OpenAbout)}"
                                app:icon="@drawable/ic_baseline_info"
                                app:subtext="@string/about_app"
                                app:text="@string/about" />
                        </LinearLayout>
                    </com.google.android.material.card.MaterialCardView>
                </androidx.gridlayout.widget.GridLayout>
            </LinearLayout>
        </androidx.core.widget.NestedScrollView>
    </androidx.coordinatorlayout.widget.CoordinatorLayout>
</layout>
